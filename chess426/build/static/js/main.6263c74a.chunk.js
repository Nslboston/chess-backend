(this.webpackJsonpchess426=this.webpackJsonpchess426||[]).push([[0],{122:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n.n(c),a=n(63),r=n.n(a),i=(n(69),n(2)),o=n.n(i),l=n(6),j=n(5),u=(n.p,n(26),n(18)),d=n.n(u),h=n(22),b=n(7),m=n.n(b),O=n(19),p="https://immense-savannah-41501.herokuapp.com",x=n.n(O)()("".concat(p),{withCredentials:!0}),f=n(0);function v(e){var t=e.opponent,n=e.side,a=e.userInfo,r=e.gameInfo;var i,u=function(e){return"AI (3000)"!=e&&"Random (0)"!=e&&""!=e},b=Object(c.useState)("start"),O=Object(j.a)(b,2),p=O[0],v=O[1],g=Object(c.useState)(new h),w=Object(j.a)(g,2),N=w[0],k=w[1],y=Object(c.useState)({white:3e5,black:3e5}),I=Object(j.a)(y,2),S=I[0],C=I[1],A=Object(c.useState)(""),L=Object(j.a)(A,2),T=L[0],q=L[1];function P(){var e=N.moves();if(!N.game_over()){var t=Math.floor(Math.random()*e.length);N.move(e[t]),v(N.fen()),E()}}Object(c.useEffect)((function(){if(u(t)){var e=setInterval((function(){!function(){if(!N.game_over()){var e=Date.now();if(console.log(N.turn()),"w"==N.turn()){var t=S.white-(e-i);S={white:t,black:S.black},C((function(){return{white:t,black:S.black}}))}else{var n=S.black-(e-i);S={white:S.white,black:n},C({white:S.white,black:n})}i=e}}()}),100);return i=Date.now(),console.log("this works at least"),x.on("chess response",(function(e){console.log("Response received"),console.log("".concat(e));var n=new h;if(n.load_pgn(e.pgn),S={white:e.whiteTime,black:e.blackTime},C({white:e.whiteTime,black:e.blackTime}),v(n.fen()),N=n,k(n),N.in_check()){var c=Y()?"You are":"".concat(t," is");T=T.concat("".concat(c," in check!\n")),q(T)}else q("")})),x.on("game over",(function(t){clearInterval(e),setTimeout((function(){"draw"==t.winner?(T=T.concat("Draw! No one wins!"),q(T)):(T=T.concat("Game Over! ".concat(t.winner," wins!")),q(T))}),100)})),x.on("elo message",(function(e){setTimeout((function(){T=T.concat("\n".concat(e.winner.username," now has elo ").concat(e.winner.elo," and ").concat(e.loser.username," now has elo ").concat(e.loser.elo)),q(T)}),200)})),function(){x.removeAllListeners("chess response"),x.removeAllListeners("game over"),x.removeAllListeners("elo message"),clearInterval(e)}}}),[]);var R=function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m()({method:"post",url:"https://chess.apurn.com/nextmove",headers:{"Content-Type":"text/plain"},data:N.fen()});case 3:t=e.sent,console.log(t),D(t.data.substring(0,2),t.data.substring(2,4)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Whoops!");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),D=function(e,n){var c={from:e,to:n,promotion:"q"};if(null==N.move(c))return!1;if(v(N.fen()),E(),u(t)){var s={id:r.id,move:c};x.emit("chess move",s)}return!0},E=function(){var e="";N.in_check()&&!u(t)?e=void 0!=n?e.concat("".concat(Y()?"You are":"Your opponent is"," in check!\n")):e.concat("".concat("w"==N.turn()?"White":"Black"," is in check!\n")):N.in_check()||u(t)||q(""),console.log(N.in_check()),N.game_over()&&!u(t)&&(e=e.concat("Game Over!")),q(e)};function _(e){return e<0?"Out of Time!":new Date(e).toISOString().substr(11,8)}function Y(){return"w"==N.turn()&&"white"==n||"b"==N.turn()&&"black"==n||"w"==N.turn()&&""==n}return Object(f.jsx)("div",{className:"container",children:Object(f.jsx)("div",{className:"columns is-centered",children:Object(f.jsxs)("div",{className:"column is-desktop is-half",children:[Object(f.jsx)("h5",{className:"title is-5",children:t}),Object(f.jsx)(d.a,{onSquareClick:function(e){console.log(e)},transitionDuration:0,position:p,onDrop:function(e){var c=e.sourceSquare,s=e.targetSquare;"white"==n&&"b"==N.turn()||"black"==n&&"w"==N.turn()||D(c,s)&&("AI (3000)"==t?R():"Random (0)"==t&&setTimeout((function(){P()}),200))},orientation:n,className:"centered"}),Object(f.jsx)("br",{}),Object(f.jsx)("p",{className:"title is-5",children:a.loggedIn?"".concat(a.username," (").concat(a.elo,")"):"Guest (1000?)"}),""==t||"AI (3000)"==t||"Random (0)"==t?Object(f.jsx)("button",{className:"button",onClick:function(){v("start"),k(new h),q("")},children:"Reset"}):Object(f.jsx)(s.a.Fragment,{}),u(t)?Object(f.jsxs)("div",{children:[Object(f.jsx)("p",{className:Y()?"":"bolded",children:"Opponent: ".concat(_("white"==n?S.black:S.white))}),Object(f.jsx)("p",{className:Y()?"bolded":"",children:"You: ".concat(_("white"==n?S.white:S.black))})]}):Object(f.jsx)(s.a.Fragment,{}),Object(f.jsx)("div",{className:"container",children:Object(f.jsx)("p",{className:"title is-5 wNewLine",children:T})})]})})})}n(117);var g=n(17),w=n(3);function N(){var e=Object(c.useState)([]),t=Object(j.a)(e,2),n=t[0],s=t[1],a=function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m()({method:"get",url:"".concat(p,"/leaderboard"),withCredentials:!0});case 3:void 0!=(t=e.sent).data&&s(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){a().then()}),[]),Object(f.jsx)("div",{className:"container",children:Object(f.jsx)("div",{className:"columns is-centered",children:Object(f.jsx)("div",{className:"column is-narrow",children:Object(f.jsx)("div",{className:"center",children:Object(f.jsx)("table",{className:"table center",children:Object(f.jsxs)("thead",{children:[Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{children:Object(f.jsx)("abbr",{title:"Position",children:"Pos"})}),Object(f.jsx)("th",{children:"Username"}),Object(f.jsx)("th",{children:"Elo"}),Object(f.jsx)("th",{children:"Wins"}),Object(f.jsx)("th",{children:"Losses"}),Object(f.jsx)("th",{children:"Draws"})]}),n.sort((function(e,t){return t.elo-e.elo})).map((function(e,t){return Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{children:t+1}),Object(f.jsx)("td",{children:e.username}),Object(f.jsx)("td",{children:e.elo}),Object(f.jsx)("td",{children:e.wins}),Object(f.jsx)("td",{children:e.losses}),Object(f.jsx)("td",{children:e.draws})]},e.username)}))]})})})})})})}function k(e){var t=e.info,n=e.setInfo,s=Object(c.useState)(""),a=Object(j.a)(s,2),r=a[0],i=a[1],u=Object(c.useState)(""),d=Object(j.a)(u,2),h=d[0],b=d[1];function O(){return(O=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m()({method:"post",url:"".concat(p,"/api/auth/register_login"),data:{username:r,password:h},withCredentials:!0});case 3:t=e.sent,console.log(t),n({loggedIn:!0,username:r}),i(""),b(""),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}return t.loggedIn?Object(f.jsxs)("p",{className:"center",children:["You have successfully logged in as ",t.username]}):Object(f.jsx)("div",{className:"container",children:Object(f.jsx)("div",{className:"columns",children:Object(f.jsx)("div",{className:"column is-narrow-desktop is-centered",children:Object(f.jsxs)("div",{className:"field",children:[Object(f.jsx)("input",{type:"text",className:"input",placeholder:"Username",onChange:function(e){i(e.target.value)},value:r}),Object(f.jsx)("input",{type:"password",className:"input",placeholder:"Password",onChange:function(e){b(e.target.value)},value:h}),Object(f.jsx)("button",{onClick:function(){return O.apply(this,arguments)},className:"button",children:"Login"})]})})})})}function y(){var e=Object(c.useState)({}),t=Object(j.a)(e,2),n=t[0],s=t[1],a=function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Finding profile"),e.prev=1,e.next=4,m()({method:"get",url:"".concat(p,"/api/auth/profile"),withCredentials:!0});case 4:void 0!=(t=e.sent).data&&s(t.data),console.log(t.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){a().then()}),[]),void 0!=n&&"{}"!=JSON.stringify(n)&&'""'!=JSON.stringify(n)?(console.log(JSON.stringify(n)),console.log("This is "),Object(f.jsxs)("div",{className:"centered",children:[Object(f.jsx)("p",{className:"title is-3",children:n.username}),Object(f.jsx)("p",{className:"title is-5",children:"Record: ".concat(n.stats.wins,"-").concat(n.stats.losses,"-").concat(n.stats.draws)}),Object(f.jsx)("p",{className:"title is-5",children:"Elo: ".concat(n.stats.elo)})]})):Object(f.jsx)("p",{})}function I(e){var t=e.userInfo,n=Object(c.useState)({name:"Loading...",elo:1e3}),s=Object(j.a)(n,2),a=s[0],r=s[1],i=Object(c.useState)(""),u=Object(j.a)(i,2),d=u[0],h=u[1];function b(){return(b=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"",e.next=3,x.emit("queue",(function(e){"ok"==e.status&&h("queuing")}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return(m=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"",e.next=3,x.emit("exit queue",(function(e){"ok"==e.status&&h("")}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.useEffect)((function(){x.on("game start",(function(e){r(e),h("game")}))}),[]),t.loggedIn?""==d?Object(f.jsxs)("div",{className:"container",children:[Object(f.jsx)("div",{className:"columns is-centered",children:Object(f.jsx)("div",{className:"column is-narrow",children:Object(f.jsx)("button",{onClick:function(){return b.apply(this,arguments)},className:"button center",children:"Start queueing"})})}),Object(f.jsx)("p",{className:"center",children:"You may need to reload for this button to work."})]}):"queuing"==d?Object(f.jsx)("div",{className:"container",children:Object(f.jsx)("div",{className:"columns is-centered",children:Object(f.jsx)("div",{className:"column is-narrow",children:Object(f.jsx)("button",{onClick:function(){return m.apply(this,arguments)},className:"button",children:"Stop queueing"})})})}):"game"==d?Object(f.jsx)(v,{opponent:"".concat(a.name," (").concat(a.elo,")"),side:a.side,userInfo:t,gameInfo:{id:a.id,time:a.time}}):Object(f.jsx)("p",{children:"You shouldn't see this"}):Object(f.jsx)("p",{children:"Not logged in!"})}function S(){return Object(f.jsx)("div",{className:"container",children:Object(f.jsx)("div",{className:"columns",children:Object(f.jsxs)("div",{className:"column is-one-half-desktop is-centered",children:[Object(f.jsx)("h1",{className:"title is-3",children:"Welcome to Chess426!"}),Object(f.jsx)("p",{children:"You can use most of the features of this site without logging in. Use the top bar to view the leaderboard of the best online players, and play chess against either yourself, an AI that makes random moves, or an AI that will almost certainly beat you every time."}),Object(f.jsx)("br",{}),Object(f.jsx)("p",{children:'Logging in allows you to access multiplayer games: Simply enter the multiplayer tab and start queuing to be matched using a "matchmaking system" that matches you with the next person to start queuing. Don\'t expect your rating to have anything to do with the skill of your opponent. Note that logging in and registering use the same form'}),Object(f.jsx)("br",{}),Object(f.jsx)("p",{children:"This website uses an elo system to handle your ranking, so this isn't as bad as it seems; If you lose to a superior opponent, you will lose less points than if you lose to an inferior one. This helps to reduce the impact of mismatched games on your overall rating, though wins and losses update the same way regardless of the ranking of your opponent."}),Object(f.jsx)("br",{}),Object(f.jsx)("p",{children:"If you get stuck, try reloading the page. It usually fixes the problem."}),Object(f.jsx)("br",{}),Object(f.jsx)("p",{className:"title is-4",children:"Libraries used:"}),Object(f.jsx)("b",{children:"Client Side:"}),Object(f.jsx)("div",{className:"container",children:Object(f.jsxs)("ul",{className:"",children:[Object(f.jsx)("li",{children:"React"}),Object(f.jsx)("li",{children:"React-Router"}),Object(f.jsx)("li",{children:"Chess.js"}),Object(f.jsx)("li",{children:"Chessboard.jsx"}),Object(f.jsx)("li",{children:"Axios"}),Object(f.jsx)("li",{children:"Bulma"})]})}),Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:"Server Side:"}),Object(f.jsx)("div",{className:"container",children:Object(f.jsxs)("ul",{className:"",children:[Object(f.jsx)("li",{children:"Node.js"}),Object(f.jsx)("li",{children:"Express.js"}),Object(f.jsx)("li",{children:"Express-session"}),Object(f.jsx)("li",{children:"Passport.js"}),Object(f.jsx)("li",{children:"Socket.io"}),Object(f.jsx)("li",{children:"MongoDB"})]})}),Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:"AJAX APIs:"}),Object(f.jsx)("br",{}),Object(f.jsx)("a",{href:"https://github.com/albertputrapurnama/stockfish-api",children:"Stockfish-API"})]})})})}var C=function(){var e=Object(c.useState)({loggedIn:!1,username:"",elo:1e3}),t=Object(j.a)(e,2),n=t[0],s=t[1],a=function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m()({method:"get",url:"".concat(p,"/api/auth/profile"),withCredentials:!0});case 3:""!=(t=e.sent).data&&s({loggedIn:!0,username:t.data.username,elo:t.data.stats.elo}),console.log(t.data),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),r=function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m()({method:"get",url:"".concat(p,"/api/auth/logout"),withCredentials:!0});case 3:e.sent,s({loggedIn:!1,username:""}),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){a().then()}),[]),Object(f.jsxs)(g.a,{children:[Object(f.jsxs)("nav",{className:"navbar",children:[Object(f.jsxs)("div",{className:"navbar-menu",children:[Object(f.jsx)("a",{className:"navbar-item",children:Object(f.jsx)(g.b,{to:"/",children:"Home"})}),Object(f.jsx)("a",{className:"navbar-item",children:Object(f.jsx)(g.b,{to:"/leaderboard",children:"Leaderboard"})}),Object(f.jsx)("a",{className:"navbar-item",children:Object(f.jsx)(g.b,{to:"/board",children:"Local Game"})}),Object(f.jsx)("a",{className:"navbar-item",children:Object(f.jsx)(g.b,{to:"/boardai",children:"Play vs. AI (Good Luck!)"})}),Object(f.jsx)("a",{className:"navbar-item",children:Object(f.jsx)(g.b,{to:"/boardrandom",children:"Play vs. AI (Random Moves)"})}),Object(f.jsx)("a",{className:"navbar-item",children:Object(f.jsx)(g.b,{to:"/profile",children:"Profile"})}),Object(f.jsx)("a",{className:"navbar-item",children:Object(f.jsx)(g.b,{to:"/multiplayer",children:"Multiplayer"})})]}),Object(f.jsxs)("div",{className:"navbar-end",children:[Object(f.jsx)("div",{className:"navbar-item",children:Object(f.jsx)("p",{children:n.username})}),Object(f.jsx)("div",{className:"navbar-item",children:Object(f.jsx)("button",{className:"button",onClick:r,children:"Log Out"})}),Object(f.jsx)("div",{className:"navbar-item",children:Object(f.jsx)(g.b,{to:"/login",children:Object(f.jsx)("button",{className:"button",children:"Login"})})})]})]}),Object(f.jsx)("hr",{}),Object(f.jsxs)(w.c,{children:[Object(f.jsx)(w.a,{exact:!0,path:"/",children:Object(f.jsx)(S,{})}),Object(f.jsx)(w.a,{path:"/board",component:function(){return Object(f.jsx)(v,{opponent:"",userInfo:n})}}),Object(f.jsx)(w.a,{path:"/leaderboard",children:Object(f.jsx)(N,{})}),Object(f.jsx)(w.a,{path:"/boardai",component:function(){return Object(f.jsx)(v,{opponent:"AI (3000)",side:"white",userInfo:n})}}),Object(f.jsx)(w.a,{path:"/boardrandom",component:function(){return Object(f.jsx)(v,{opponent:"Random (0)",side:"white",userInfo:n})}}),Object(f.jsx)(w.a,{path:"/login",children:Object(f.jsx)(k,{info:n,setInfo:s})}),Object(f.jsx)(w.a,{path:"/profile",children:Object(f.jsx)(y,{})}),Object(f.jsx)(w.a,{path:"/multiplayer",children:Object(f.jsx)(I,{userInfo:n})})]})]})},A=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,123)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,a=t.getLCP,r=t.getTTFB;n(e),c(e),s(e),a(e),r(e)}))};r.a.render(Object(f.jsx)(s.a.StrictMode,{children:Object(f.jsx)(C,{})}),document.getElementById("root")),A()},26:function(e,t,n){},69:function(e,t,n){}},[[122,1,2]]]);
//# sourceMappingURL=main.6263c74a.chunk.js.map